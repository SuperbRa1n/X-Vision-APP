import{c as t,w as e,i as a,o as i,a as l,b as o,d as s,M as n,e as r,f as c}from"./index-CYoipJ9W.js";import{a as d,g as u,b as g}from"./api.CwOjVojJ.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";const m=h({data:()=>({latitude:34.223,longitude:108.952,scale:15,polyline:[],locations:[],words:[],images:[],currentIndex:0,markers:[{latitude:0,longitude:0,iconPath:"../../static/local.png",width:30,height:30}]}),methods:{async getTextFromApi(){try{const t=await d(),e={};t.forEach((t=>{t.text.split(" ").forEach((t=>{e[t]=(e[t]||0)+1}))})),this.words=Object.keys(e).map((t=>({text:t,weight:e[t]}))),this.generateWordCloud()}catch(t){console.error("Failed to fetch text data:",t)}},generateWordCloud(){const t=document.getElementById("wordcloud");WordCloud(t,{list:this.words.map((t=>[t.text,t.weight])),gridSize:20,weightFactor:20,fontFamily:"Verdana, Geneva, sans-serif",color:"random-light",rotateRatio:.5,rotationSteps:2,backgroundColor:"#fff"})},async getLocationFromApi(){try{const t=await u();if(t.length>0){this.locations=t.filter(((t,e)=>e%10==0)),this.polyline=[{points:t.map((t=>({latitude:t.latitude,longitude:t.longitude}))),color:"#FF0000",width:2,dottedLine:!1}];const e=t[t.length-1];this.latitude=e.latitude,this.longitude=e.longitude,this.markers=[{latitude:e.latitude,longitude:e.longitude,iconPath:"../../static/local.png",width:30,height:30}]}}catch(t){console.error("Failed to fetch location data:",t)}},async getImageFromApi(){try{const t=await g();this.images=t}catch(t){console.error("Failed to fetch image data:",t)}},prevImage(){this.currentIndex>0&&this.currentIndex--},nextImage(){this.currentIndex<this.images.length-1&&this.currentIndex++}},mounted(){this.getTextFromApi(),this.getLocationFromApi(),this.getImageFromApi(),setInterval((()=>{this.getTextFromApi(),this.getLocationFromApi(),this.getImageFromApi()}),3e3)}},[["render",function(d,u,g,h,m,f){const p=a,w=n,_=r,x=c;return i(),t(p,{class:"container"},{default:e((()=>[l(p,{class:"section"},{default:e((()=>[l(p,{class:"section-title"},{default:e((()=>[o("轨迹地图")])),_:1}),l(p,{class:"track-container"},{default:e((()=>[l(w,{style:{width:"98vw",height:"30vh"},latitude:m.latitude,longitude:m.longitude,scale:m.scale,polyline:m.polyline,markers:m.markers},null,8,["latitude","longitude","scale","polyline","markers"])])),_:1})])),_:1}),l(p,{class:"section"},{default:e((()=>[l(p,{class:"section-title"},{default:e((()=>[o("词云")])),_:1}),l(p,{class:"wordcloud-container"},{default:e((()=>[l(_,{id:"wordcloud",style:{width:"98vw",height:"25vh"}})])),_:1})])),_:1}),l(p,{class:"section"},{default:e((()=>[l(p,{class:"section-title"},{default:e((()=>[o("查看图片")])),_:1}),l(p,{class:"image-container"},{default:e((()=>[l(p,{class:"switch-btn left-btn",onClick:f.prevImage},{default:e((()=>[l(x,null,{default:e((()=>[o("<")])),_:1})])),_:1},8,["onClick"]),l(p,{class:"image-item"},{default:e((()=>{var t;return[s("img",{src:null==(t=m.images[m.currentIndex])?void 0:t.url,mode:"aspectFill",class:"image"},null,8,["src"])]})),_:1}),l(p,{class:"switch-btn right-btn",onClick:f.nextImage},{default:e((()=>[l(x,null,{default:e((()=>[o(">")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-b254aded"]]);export{m as default};
